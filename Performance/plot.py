import matplotlib.pyplot as plt
import numpy as np
import math

# n = 10
# x_vals   = [200,400,600,800,1000,1200,1400,1600,1800,2000,2200,2400,2600,2800,3000,3200,3400,3600,3800,4000,4200,4400,4600,4800,5000,5200,5400,5600,5800,6000,6200,6400,6600,6800,7000,7200,7400,7600,7800,8000,8200,8400,8600,8800,9000,9200,9400,9600,9800]
# y_vals = [[121.0,142.0,112.0,139.0,116.0,115.0,113.0,116.0,127.0,113.0],[274.0,275.0,232.0,237.0,238.0,232.0,232.0,235.0,274.0,231.0],[414.0,411.0,404.0,423.0,411.0,402.0,435.0,407.0,401.0,415.0],[671.0,677.0,636.0,651.0,677.0,673.0,653.0,705.0,661.0,669.0],[989.0,969.0,966.0,964.0,954.0,987.0,988.0,961.0,957.0,1006.0],[1436.0,1423.0,1355.0,1387.0,1377.0,1397.0,1375.0,1416.0,1401.0,1415.0],[1918.0,1950.0,1860.0,1898.0,1897.0,1906.0,1874.0,1865.0,1876.0,1895.0],[2450.0,2527.0,2440.0,2423.0,2427.0,2429.0,2468.0,2490.0,2435.0,2451.0],[3174.0,3157.0,3076.0,3092.0,3076.0,3090.0,3080.0,3098.0,3084.0,3102.0],[3877.0,4111.0,4203.0,3994.0,3856.0,3853.0,4106.0,3965.0,4137.0,4075.0],[4970.0,4692.0,4640.0,4875.0,4737.0,4679.0,4758.0,4744.0,4708.0,4653.0],[5634.0,5629.0,5634.0,5754.0,5600.0,5643.0,5659.0,5647.0,5652.0,5586.0],[6616.0,6759.0,6605.0,6820.0,6596.0,6564.0,6595.0,6592.0,6608.0,6570.0],[7706.0,7729.0,7901.0,7771.0,7728.0,7783.0,7711.0,7664.0,7771.0,7701.0],[8916.0,8901.0,8909.0,8866.0,8907.0,9089.0,8932.0,8932.0,9141.0,8858.0],[10375.0,10115.0,10187.0,10184.0,10213.0,10179.0,10272.0,10181.0,10217.0,10155.0],[11596.0,11626.0,11583.0,11629.0,11579.0,11587.0,11699.0,11638.0,11533.0,11555.0],[13088.0,13133.0,13168.0,13091.0,13541.0,13058.0,13401.0,13015.0,13016.0,13016.0],[14698.0,14652.0,14655.0,14712.0,14682.0,14705.0,14453.0,14979.0,15023.0,14631.0],[16476.0,16947.0,16919.0,16284.0,16315.0,16377.0,16437.0,16334.0,16301.0,16353.0],[18420.0,18057.0,18169.0,18086.0,18336.0,18139.0,18214.0,18148.0,18181.0,18082.0],[20023.0,20683.0,20086.0,20025.0,19904.0,20095.0,20112.0,20114.0,19999.0,20603.0],[21852.0,22113.0,21932.0,22727.0,22184.0,22042.0,22075.0,22031.0,22708.0,22138.0],[24121.0,24201.0,24517.0,24199.0,24072.0,24136.0,24106.0,25005.0,23902.0,24271.0],[26387.0,26394.0,26344.0,26476.0,26477.0,27125.0,27185.0,26411.0,26340.0,26239.0],[28577.0,28822.0,28847.0,28848.0,28754.0,28498.0,28789.0,28762.0,28767.0,28714.0],[31080.0,32237.0,31038.0,31094.0,31123.0,31266.0,31191.0,31118.0,31190.0,31159.0],[35053.0,33734.0,34701.0,33731.0,34571.0,33567.0,33655.0,33582.0,34617.0,33667.0],[36367.0,37168.0,36332.0,36290.0,36044.0,35995.0,36211.0,36257.0,36734.0,36262.0],[38850.0,38892.0,38936.0,38997.0,38726.0,38964.0,38597.0,38700.0,39147.0,39047.0],[43209.0,41604.0,41883.0,42037.0,43785.0,42986.0,43076.0,43148.0,43172.0,41552.0],[44648.0,44479.0,44374.0,44184.0,44704.0,44635.0,44634.0,44676.0,44939.0,46055.0],[48212.0,48150.0,48210.0,47841.0,47677.0,47564.0,49122.0,47884.0,47903.0,49462.0],[52520.0,50902.0,50907.0,51086.0,51382.0,51242.0,50671.0,50796.0,50967.0,50906.0],[54430.0,55714.0,54170.0,54381.0,53896.0,53498.0,54035.0,54620.0,54296.0,56319.0],[57569.0,57690.0,57477.0,57844.0,57647.0,57723.0,57207.0,59319.0,57591.0,57208.0],[61029.0,61651.0,61136.0,61010.0,61231.0,60861.0,60403.0,61264.0,61433.0,61400.0],[65142.0,64270.0,65266.0,65501.0,64725.0,67024.0,67553.0,66242.0,67206.0,65932.0],[71068.0,69913.0,72091.0,70315.0,71463.0,70630.0,71720.0,69631.0,69229.0,68524.0],[73702.0,73470.0,72920.0,73236.0,72303.0,72871.0,73106.0,72548.0,72518.0,72441.0],[76776.0,77559.0,77503.0,78157.0,78112.0,77785.0,77704.0,78414.0,81563.0,80224.0],[81711.0,83166.0,81163.0,81817.0,80607.0,84535.0,80884.0,81362.0,82200.0,80848.0],[84815.0,84958.0,84307.0,87952.0,84886.0,87813.0,85236.0,84610.0,87251.0,85084.0],[88589.0,89639.0,91914.0,88664.0,92293.0,89530.0,88575.0,88922.0,88842.0,89449.0],[93143.0,94912.0,93361.0,93736.0,96577.0,95864.0,93633.0,95083.0,94138.0,94464.0],[99893.0,100000.0,98329.0,99113.0,97949.0,99007.0,98754.0,97873.0,100692.0,98083.0],[103097.0,104155.0,105387.0,103755.0,102369.0,103494.0,102201.0,103115.0,102448.0,103317.0],[110943.0,109277.0,110654.0,108436.0,107215.0,108584.0,110812.0,107577.0,106759.0,107791.0],[113666.0,112429.0,112658.0,112319.0,112051.0,115891.0,113727.0,116405.0,112101.0,112292.0]]


# y_mean = list(map(lambda l: np.mean(l), y_vals))
# x_log = list(map(lambda x: math.log(x, 2), x_vals))
# f = list(map(lambda x: 2 * x - 13.35 + math.log(x, 2), x_log))
# y_mean_log = list(map(lambda x: math.log(x, 2), y_mean))
# y_log = list(map(lambda l: list(map(lambda y: math.log(y, 2), l)), y_vals))

# handle_y_mean_log, = plt.plot(x_log, y_mean_log)
# handle_f, =plt.plot(x_log, f)
# plt.legend([handle_y_mean_log, handle_f], ['Internal (Naive) Mean', 'O(N^2log(N))'])
# plt.xlabel('log(N)', fontsize=18)
# plt.ylabel('log(t [ms])', fontsize=16)

# x_souffle = [4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912]

# y_souffle = [[12.0,12.0,11.0,16.0,13.0,11.0,12.0,12.0,12.0,12.0],[16.0,15.0,18.0,15.0,15.0,15.0,22.0,16.0,15.0,22.0],[22.0,23.0,24.0,36.0,23.0,22.0,23.0,23.0,22.0,26.0],[36.0,35.0,36.0,37.0,36.0,37.0,38.0,35.0,37.0,35.0],[64.0,67.0,75.0,72.0,65.0,64.0,64.0,65.0,64.0,64.0],[133.0,122.0,118.0,122.0,122.0,122.0,119.0,119.0,120.0,125.0],[234.0,248.0,233.0,233.0,228.0,242.0,237.0,232.0,230.0,235.0],[492.0,471.0,462.0,458.0,461.0,471.0,459.0,462.0,459.0,451.0],[959.0,917.0,912.0,920.0,1000.0,915.0,924.0,931.0,925.0,916.0],[1898.0,1842.0,1837.0,1858.0,1818.0,1827.0,1883.0,1835.0,1826.0,1828.0],[3711.0,3793.0,3680.0,3685.0,3711.0,3745.0,3698.0,3675.0,3649.0,3656.0],[7384.0,7365.0,7387.0,7417.0,7379.0,7268.0,7290.0,7355.0,7356.0,7331.0],[14705.0,14798.0,15099.0,14923.0,15362.0,15526.0,14601.0,14708.0,14787.0,14910.0],[29633.0,29726.0,29637.0,30751.0,29665.0,29748.0,30303.0,29737.0,29586.0,29969.0],[59545.0,60165.0,60737.0,59897.0,60021.0,59980.0,59827.0,60263.0,59763.0,59865.0],[120221.0,122110.0,121705.0,121292.0,122638.0,120535.0,120870.0,122246.0,125100.0,122424.0],[248762.0,244341.0,241234.0,242829.0,247550.0,243267.0,242872.0,241516.0,243735.0,241550.0],[531338.0,398288.0,475812.0,386799.0,528896.0,388645.0,467581.0,434275.0,448459.0,472116.0]]
# x_souffle_log = list(map(lambda x: math.log(x, 2), x_souffle))
# y_souffle_mean = list(map(lambda l: np.mean(l), y_souffle))
# y_souffle_mean_log = list(map(lambda x: math.log(x, 2), y_souffle_mean))
# g = list(map(lambda x: x - 10, x_souffle_log))
# h = list(map(lambda x: x - 14.45 + math.log(x, 2), x_souffle_log))
# handle_y_souffle_mean_log, = plt.plot(x_souffle_log, y_souffle_mean_log)
# handle_g, = plt.plot(x_souffle_log, g)
# handle_h, = plt.plot(x_souffle_log, h)
# plt.legend([handle_y_souffle_mean_log, handle_g, handle_h], ['Souffle Mean', 'O(N)', 'O(Nlog(N))'])
# plt.xlabel('log(N)', fontsize=18)
# plt.ylabel('log(t [ms])', fontsize=16)

x_internal = [5 * x for x in range(1, 52 + 1)]
y_internal = [[6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0],
             [15.0, 12.0, 14.0, 12.0, 15.0, 12.0, 17.0, 17.0, 15.0, 14.0],
             [21.0, 28.0, 21.0, 27.0, 27.0, 22.0, 28.0, 28.0, 27.0, 21.0],
             [54.0, 39.0, 38.0, 56.0, 57.0, 39.0, 39.0, 40.0, 57.0, 41.0],
             [66.0, 65.0, 65.0, 95.0, 67.0, 94.0, 67.0, 66.0, 101.0, 70.0],
             [112.0, 115.0, 112.0, 113.0, 122.0, 109.0, 124.0, 117.0, 117.0, 111.0],
             [180.0, 198.0, 206.0, 214.0, 176.0, 185.0, 176.0, 177.0, 206.0, 180.0],
             [286.0, 277.0, 299.0, 276.0, 283.0, 288.0, 275.0, 304.0, 268.0, 315.0],
             [397.0, 413.0, 402.0, 408.0, 396.0, 432.0, 465.0, 406.0, 450.0, 432.0],
             [565.0, 633.0, 569.0, 561.0, 562.0, 566.0, 579.0, 647.0, 565.0, 566.0],
             [810.0, 932.0, 805.0, 790.0, 933.0, 820.0, 907.0, 805.0, 811.0, 804.0],
             [1276.0, 1255.0, 1230.0, 1237.0, 1103.0, 1135.0, 1266.0, 1283.0, 1087.0, 1237.0],
             [1703.0, 1465.0, 1480.0, 1672.0, 1484.0, 1502.0, 1670.0, 1669.0, 1515.0, 1496.0],
             [2268.0, 1995.0, 1935.0, 2181.0, 1951.0, 2235.0, 2239.0, 2226.0, 2221.0, 2205.0],
             [2574.0, 2932.0, 2826.0, 2915.0, 2519.0, 2931.0, 2546.0, 2553.0, 2561.0, 2562.0],
             [3316.0, 3782.0, 3199.0, 3698.0, 3661.0, 3237.0, 3229.0, 3211.0, 3225.0, 3244.0],
             [4768.0, 4125.0, 4746.0, 4105.0, 4125.0, 4834.0, 4680.0, 4140.0, 4599.0, 4680.0],
             [5895.0, 5985.0, 6066.0, 5064.0, 5238.0, 5099.0, 5776.0, 5299.0, 5148.0, 5119.0],
             [7320.0, 7573.0, 7281.0, 7186.0, 6296.0, 6320.0, 7293.0, 7184.0, 6295.0, 6302.0],
             [7647.0, 9048.0, 8787.0, 7672.0, 7737.0, 9046.0, 8701.0, 8749.0, 8753.0, 7715.0],
             [10864.0, 9356.0, 11084.0, 10814.0, 10642.0, 9264.0, 10924.0, 9470.0, 10887.0, 10841.0],
             [11313.0, 12958.0, 11123.0, 13301.0, 11342.0, 12792.0, 11229.0, 12586.0, 11055.0, 12999.0],
             [13365.0, 15307.0, 13391.0, 13508.0, 15675.0, 13336.0, 13592.0, 15907.0, 15041.0, 13353.0],
             [15875.0, 15644.0, 15823.0, 18912.0, 15891.0, 15713.0, 15712.0, 15951.0, 15909.0, 15722.0],
             [18481.0, 18523.0, 18710.0, 21412.0, 18625.0, 21192.0, 20888.0, 18680.0, 18699.0, 21179.0],
             [25249.0, 21822.0, 21581.0, 21744.0, 25157.0, 21702.0, 21469.0, 21362.0, 22169.0, 24969.0],
             [28629.0, 25498.0, 25239.0, 25235.0, 25103.0, 29537.0, 25217.0, 29216.0, 29227.0, 29257.0],
             [28825.0, 33916.0, 29247.0, 34826.0, 33142.0, 28959.0, 28881.0, 29018.0, 29458.0, 33703.0],
             [33042.0, 33297.0, 33433.0, 33543.0, 33018.0, 33079.0, 33455.0, 37555.0, 33132.0, 33353.0],
             [43775.0, 38153.0, 43121.0, 37871.0, 38135.0, 38104.0, 44049.0, 45248.0, 38022.0, 38131.0],
             [49900.0, 50120.0, 49893.0, 50185.0, 49745.0, 50207.0, 50073.0, 43133.0, 44020.0, 43418.0],
             [48781.0, 55544.0, 56593.0, 56239.0, 49946.0, 57349.0, 49376.0, 57406.0, 49912.0, 49589.0],
             [55333.0, 66064.0, 55701.0, 64435.0, 55629.0, 56067.0, 64344.0, 63790.0, 64207.0, 63800.0],
             [70429.0, 70317.0, 72002.0, 62942.0, 71807.0, 63274.0, 73949.0, 72745.0, 69904.0, 71217.0],
             [80814.0, 69681.0, 82628.0, 71088.0, 80784.0, 71183.0, 79707.0, 83736.0, 79621.0, 81787.0],
             [90506.0, 92849.0, 78991.0, 90616.0, 78535.0, 90996.0, 89069.0, 93771.0, 90400.0, 78643.0],
             [102003.0, 87860.0, 99556.0, 98635.0, 87195.0, 87642.0, 104688.0, 86649.0, 104642.0, 87174.0],
             [112974.0, 113402.0, 97205.0, 111230.0, 96900.0, 115330.0, 97785.0, 97507.0, 97062.0, 111291.0],
             [124417.0, 127691.0, 106817.0, 123707.0, 108118.0, 127316.0, 124632.0, 123725.0, 122994.0, 107812.0],
             [119015.0, 135255.0, 119203.0, 140872.0, 119358.0, 138646.0, 137221.0, 121524.0, 119546.0, 138224.0],
             [157112.0, 130523.0, 131094.0, 130567.0, 131202.0, 149615.0, 154883.0, 150722.0, 131374.0, 134373.0],
             [143919.0, 143910.0, 145579.0, 144090.0, 143405.0, 146302.0, 145502.0, 167719.0, 166525.0, 144053.0],
             [159163.0, 157585.0, 156071.0, 180683.0, 185851.0, 184425.0, 160249.0, 159495.0, 186665.0, 180370.0],
             [172430.0, 175940.0, 197978.0, 199360.0, 204123.0, 175684.0, 207097.0, 202024.0, 200340.0, 201905.0],
             [194574.0, 190882.0, 189029.0, 190707.0, 191675.0, 187641.0, 191767.0, 189224.0, 219232.0, 191823.0],
             [205214.0, 206138.0, 207514.0, 207550.0, 205837.0, 206171.0, 212425.0, 207690.0, 331965.0, 205734.0],
             [230975.0, 225602.0, 226160.0, 226244.0, 225230.0, 226100.0, 225871.0, 259169.0, 224434.0, 270681.0],
             [281389.0, 246397.0, 243909.0, 281799.0, 281198.0, 249603.0, 244135.0, 246955.0, 244806.0, 245762.0],
             [270239.0, 265015.0, 266924.0, 262909.0, 265639.0, 269238.0, 265429.0, 271603.0, 268981.0, 266174.0],
             [301193.0, 333153.0, 286438.0, 298211.0, 287789.0, 287833.0, 286158.0, 289074.0, 291128.0, 293709.0],
             [311948.0, 315713.0, 313650.0, 309894.0, 351287.0, 308289.0, 315060.0, 311628.0, 364416.0, 309403.0],
             [334997.0, 394565.0, 337050.0, 337311.0, 336533.0, 336497.0, 398020.0, 338205.0, 332354.0, 342009.0]]

plt.figure()
x_internal_log = list(map(lambda x: math.log(x, 2), x_internal))
y_internal_mean = list(map(lambda l: np.mean(l), y_internal))
y_internal_mean_log = list(map(lambda x: math.log(x, 2), y_internal_mean))
h = list(map(lambda x: 4 * x - 13.5, x_internal_log))

handle_internal, = plt.plot(x_internal_log, y_internal_mean_log)
handle_h, = plt.plot(x_internal_log, h)

plt.legend([handle_internal, handle_h],
           ['Internal (Naive) Mean', 'O(N^4)'])
plt.xlabel('log(N)', fontsize=18)
plt.ylabel('log(t [ms])', fontsize=16)

plt.figure()
x_ancestor_souffle = [50 * x for x in range(1, 100 + 1)] + [8192, 16384]
y_ancestor_souffle = [[11.0, 10.0, 12.0, 11.0, 11.0, 14.0, 15.0, 12.0, 12.0, 12.0],
[17.0, 15.0, 15.0, 14.0, 14.0, 14.0, 14.0, 20.0, 20.0, 17.0],
[27.0, 23.0, 23.0, 22.0, 25.0, 25.0, 25.0, 21.0, 22.0, 22.0],
[33.0, 34.0, 32.0, 33.0, 31.0, 31.0, 33.0, 33.0, 31.0, 33.0],
[43.0, 45.0, 43.0, 44.0, 53.0, 43.0, 43.0, 43.0, 42.0, 46.0],
[70.0, 57.0, 57.0, 59.0, 60.0, 60.0, 69.0, 57.0, 61.0, 64.0],
[76.0, 76.0, 77.0, 75.0, 77.0, 81.0, 76.0, 83.0, 77.0, 79.0],
[99.0, 98.0, 101.0, 100.0, 101.0, 99.0, 97.0, 103.0, 96.0, 99.0],
[122.0, 127.0, 123.0, 128.0, 124.0, 135.0, 122.0, 121.0, 129.0, 128.0],
[156.0, 163.0, 160.0, 153.0, 151.0, 155.0, 152.0, 158.0, 160.0, 157.0],
[183.0, 183.0, 182.0, 182.0, 190.0, 186.0, 182.0, 187.0, 184.0, 190.0],
[217.0, 216.0, 218.0, 219.0, 214.0, 226.0, 215.0, 215.0, 230.0, 222.0],
[254.0, 258.0, 257.0, 253.0, 265.0, 274.0, 257.0, 254.0, 255.0, 253.0],
[298.0, 294.0, 309.0, 296.0, 313.0, 292.0, 295.0, 292.0, 305.0, 293.0],
[338.0, 347.0, 356.0, 352.0, 339.0, 337.0, 343.0, 339.0, 339.0, 353.0],
[386.0, 384.0, 393.0, 389.0, 390.0, 401.0, 382.0, 392.0, 384.0, 389.0],
[441.0, 434.0, 441.0, 444.0, 446.0, 448.0, 452.0, 437.0, 444.0, 447.0],
[490.0, 493.0, 488.0, 505.0, 490.0, 487.0, 498.0, 492.0, 509.0, 490.0],
[548.0, 556.0, 551.0, 553.0, 566.0, 541.0, 557.0, 560.0, 554.0, 540.0],
[614.0, 614.0, 626.0, 612.0, 602.0, 604.0, 611.0, 613.0, 624.0, 606.0],
[673.0, 685.0, 659.0, 682.0, 678.0, 683.0, 661.0, 681.0, 687.0, 685.0],
[761.0, 757.0, 739.0, 730.0, 729.0, 749.0, 753.0, 741.0, 760.0, 740.0],
[823.0, 804.0, 804.0, 832.0, 813.0, 804.0, 832.0, 808.0, 810.0, 803.0],
[897.0, 882.0, 903.0, 887.0, 884.0, 877.0, 874.0, 884.0, 904.0, 929.0],
[992.0, 978.0, 969.0, 956.0, 962.0, 997.0, 1054.0, 1053.0, 977.0, 991.0],
[1154.0, 1057.0, 1059.0, 1047.0, 1091.0, 1048.0, 1054.0, 1041.0, 1059.0, 1047.0],
[1157.0, 1152.0, 1136.0, 1152.0, 1143.0, 1109.0, 1151.0, 1151.0, 1130.0, 1124.0],
[1215.0, 1236.0, 1214.0, 1256.0, 1204.0, 1225.0, 1280.0, 1249.0, 1229.0, 1214.0],
[1312.0, 1334.0, 1363.0, 1302.0, 1310.0, 1296.0, 1329.0, 1319.0, 1300.0, 1327.0],
[1382.0, 1421.0, 1395.0, 1399.0, 1373.0, 1390.0, 1451.0, 1376.0, 1415.0, 1438.0],
[1488.0, 1500.0, 1481.0, 1472.0, 1477.0, 1508.0, 1506.0, 1481.0, 1539.0, 1497.0],
[1570.0, 1577.0, 1578.0, 1564.0, 1579.0, 1607.0, 1568.0, 1626.0, 1615.0, 1625.0],
[1728.0, 1968.0, 1831.0, 1911.0, 1944.0, 1702.0, 1785.0, 1761.0, 1736.0, 1686.0],
[1816.0, 1844.0, 1783.0, 1849.0, 1779.0, 1796.0, 1790.0, 1784.0, 1761.0, 1802.0],
[1931.0, 1903.0, 1902.0, 1941.0, 1882.0, 1888.0, 1975.0, 1977.0, 1950.0, 1887.0],
[2029.0, 2039.0, 2125.0, 2048.0, 1992.0, 2013.0, 2065.0, 2021.0, 2003.0, 2022.0],
[2176.0, 2137.0, 2140.0, 2116.0, 2171.0, 2112.0, 2140.0, 2119.0, 2129.0, 2134.0],
[2260.0, 2239.0, 2242.0, 2245.0, 2225.0, 2275.0, 2233.0, 2241.0, 2277.0, 2286.0],
[2472.0, 2416.0, 2409.0, 2426.0, 2364.0, 2487.0, 2478.0, 2456.0, 2680.0, 2546.0],
[2550.0, 2561.0, 2479.0, 2558.0, 2473.0, 2467.0, 2540.0, 2524.0, 2634.0, 2557.0],
[2758.0, 2638.0, 2872.0, 2802.0, 2745.0, 2698.0, 2679.0, 2701.0, 2665.0, 2659.0],
[2777.0, 2778.0, 2809.0, 2786.0, 2762.0, 2815.0, 2759.0, 2783.0, 2791.0, 2787.0],
[2972.0, 3029.0, 2980.0, 2950.0, 2917.0, 2942.0, 2926.0, 2953.0, 2939.0, 2954.0],
[3088.0, 3120.0, 3048.0, 3047.0, 3080.0, 3083.0, 3366.0, 3069.0, 3076.0, 3133.0],
[3471.0, 3313.0, 3487.0, 3301.0, 3227.0, 3220.0, 3166.0, 3207.0, 3333.0, 3194.0],
[3376.0, 3459.0, 3371.0, 3391.0, 3370.0, 3420.0, 3349.0, 3307.0, 3411.0, 3500.0],
[3558.0, 3567.0, 3537.0, 3670.0, 3499.0, 3515.0, 3496.0, 3452.0, 3661.0, 3636.0],
[3803.0, 3835.0, 3672.0, 3679.0, 3938.0, 3722.0, 3847.0, 3791.0, 3748.0, 3783.0],
[3846.0, 3941.0, 4051.0, 3952.0, 3787.0, 3894.0, 3894.0, 3852.0, 3949.0, 3845.0],
[3954.0, 4105.0, 4032.0, 4071.0, 3965.0, 3996.0, 3965.0, 3937.0, 3984.0, 3922.0],
[4173.0, 4200.0, 4221.0, 4199.0, 4424.0, 4283.0, 4373.0, 4341.0, 4172.0, 4190.0],
[4641.0, 5350.0, 4595.0, 4455.0, 4409.0, 4588.0, 4447.0, 4360.0, 4375.0, 4498.0],
[4611.0, 4641.0, 4561.0, 4510.0, 4438.0, 4497.0, 4448.0, 4509.0, 4491.0, 4503.0],
[4782.0, 4811.0, 4786.0, 4705.0, 4693.0, 4689.0, 4785.0, 4657.0, 4694.0, 4989.0],
[4907.0, 5112.0, 5105.0, 4886.0, 4867.0, 4815.0, 5005.0, 4960.0, 4813.0, 4872.0],
[5145.0, 5241.0, 5339.0, 5171.0, 5063.0, 5146.0, 5165.0, 5134.0, 5043.0, 5088.0],
[5338.0, 5486.0, 5375.0, 5296.0, 5269.0, 5284.0, 5287.0, 5218.0, 5251.0, 5237.0],
[5534.0, 5601.0, 5541.0, 5459.0, 5388.0, 5430.0, 5448.0, 5445.0, 5525.0, 5454.0],
[5631.0, 5807.0, 5855.0, 5698.0, 5566.0, 5672.0, 5600.0, 5579.0, 5759.0, 5624.0],
[5887.0, 5898.0, 5821.0, 5799.0, 5868.0, 5842.0, 5825.0, 5923.0, 5782.0, 5878.0],
[6154.0, 6139.0, 6245.0, 6115.0, 6023.0, 5978.0, 6148.0, 6063.0, 6023.0, 6041.0],
[6386.0, 6442.0, 6444.0, 6397.0, 6350.0, 6287.0, 6358.0, 6313.0, 6201.0, 6218.0],
[6663.0, 6652.0, 6619.0, 6542.0, 6483.0, 6469.0, 6475.0, 6475.0, 6541.0, 6542.0],
[6749.0, 6893.0, 6874.0, 6663.0, 6672.0, 6817.0, 6692.0, 6654.0, 6863.0, 6736.0],
[6917.0, 7136.0, 7123.0, 7066.0, 6969.0, 7014.0, 6975.0, 7001.0, 6885.0, 6893.0],
[7213.0, 7321.0, 7508.0, 7307.0, 7169.0, 7195.0, 7205.0, 7212.0, 7184.0, 7137.0],
[7503.0, 7589.0, 7714.0, 7449.0, 7521.0, 7443.0, 7719.0, 7477.0, 7425.0, 7514.0],
[7774.0, 7853.0, 7832.0, 7770.0, 8322.0, 8025.0, 7885.0, 8312.0, 7694.0, 7640.0],
[8008.0, 8212.0, 8058.0, 8187.0, 7961.0, 8010.0, 8426.0, 8455.0, 8515.0, 7976.0],
[8312.0, 9155.0, 8802.0, 8789.0, 8355.0, 8260.0, 8438.0, 8483.0, 8573.0, 8144.0],
[8470.0, 8694.0, 8681.0, 8511.0, 8455.0, 8345.0, 8346.0, 8342.0, 8361.0, 8499.0],
[8653.0, 8881.0, 9122.0, 8826.0, 8717.0, 8611.0, 8545.0, 8590.0, 8566.0, 8601.0],
[9031.0, 9165.0, 9877.0, 9311.0, 9084.0, 9011.0, 8788.0, 8829.0, 9014.0, 8934.0],
[9270.0, 9315.0, 9296.0, 9219.0, 9089.0, 9079.0, 9122.0, 9105.0, 9014.0, 9099.0],
[9313.0, 9832.0, 9624.0, 9438.0, 9417.0, 9620.0, 9737.0, 9377.0, 9348.0, 9405.0],
[9671.0, 10551.0, 10213.0, 9899.0, 9608.0, 9668.0, 9856.0, 9589.0, 9592.0, 9902.0],
[10084.0, 10335.0, 10177.0, 9962.0, 10044.0, 9877.0, 9931.0, 9912.0, 9936.0, 9953.0],
[10469.0, 10580.0, 10617.0, 10351.0, 10289.0, 10251.0, 10209.0, 10177.0, 10205.0, 10286.0],
[10669.0, 10890.0, 10868.0, 10554.0, 10528.0, 10636.0, 10627.0, 11494.0, 10547.0, 10610.0],
[10896.0, 10814.0, 10859.0, 10789.0, 11199.0, 11264.0, 10870.0, 10899.0, 11714.0, 11502.0],
[11250.0, 11422.0, 11390.0, 11025.0, 11111.0, 11187.0, 11081.0, 11015.0, 11066.0, 10990.0],
[11370.0, 11798.0, 11807.0, 11339.0, 11325.0, 11579.0, 11315.0, 11330.0, 11443.0, 11449.0],
[11657.0, 12498.0, 11936.0, 11762.0, 11859.0, 11666.0, 11725.0, 11736.0, 11597.0, 11718.0],
[12586.0, 13527.0, 13180.0, 12449.0, 13183.0, 12141.0, 12232.0, 12050.0, 11944.0, 11971.0],
[12632.0, 12881.0, 13017.0, 12525.0, 12498.0, 12359.0, 12656.0, 12664.0, 13656.0, 13514.0],
[12941.0, 13134.0, 13039.0, 13077.0, 12752.0, 13615.0, 13138.0, 12855.0, 13138.0, 14160.0],
[14556.0, 14227.0, 13605.0, 13228.0, 12977.0, 13501.0, 12980.0, 12928.0, 12948.0, 12940.0],
[13425.0, 13780.0, 13724.0, 13227.0, 13404.0, 13254.0, 13308.0, 13277.0, 13390.0, 13316.0],
[13603.0, 14221.0, 14031.0, 13572.0, 13890.0, 13657.0, 13540.0, 13731.0, 13824.0, 14017.0],
[14405.0, 15825.0, 14917.0, 14176.0, 14188.0, 14113.0, 14252.0, 14097.0, 14045.0, 13948.0],
[14484.0, 16197.0, 15497.0, 15597.0, 14457.0, 14329.0, 14440.0, 14616.0, 14336.0, 14403.0],
[14937.0, 15620.0, 15176.0, 14739.0, 14777.0, 15633.0, 14931.0, 14839.0, 14630.0, 14669.0],
[15691.0, 15747.0, 15720.0, 15215.0, 15368.0, 15388.0, 15110.0, 15426.0, 15956.0, 17085.0],
[15980.0, 16340.0, 16201.0, 16285.0, 16398.0, 16245.0, 16716.0, 16572.0, 16871.0, 16301.0],
[16540.0, 17291.0, 16768.0, 16760.0, 17261.0, 16833.0, 16775.0, 16556.0, 16428.0, 17229.0],
[17808.0, 18067.0, 17612.0, 17442.0, 17477.0, 17738.0, 17569.0, 17157.0, 16830.0, 17465.0],
[17511.0, 18436.0, 18291.0, 17686.0, 17869.0, 17408.0, 17781.0, 16913.0, 19006.0, 17005.0],
[17284.0, 17980.0, 17676.0, 17292.0, 17294.0, 17191.0, 17282.0, 17367.0, 17242.0, 18055.0],
[17761.0, 18391.0, 18127.0, 18366.0, 18738.0, 19424.0, 18119.0, 18519.0, 17898.0, 19137.0],
[18789.0, 19316.0, 19975.0, 18318.0, 18067.0, 18103.0, 18124.0, 18065.0, 18127.0, 17954.],
[58029.0, 59339.0, 60575.0, 60148.0, 60463.0, 59799.0, 58364.0, 61581.0, 57637.0, 57869.0],
[292403.0, 295647.0, 290672.0, 288273.0, 285435.0, 289622.0, 296586.0, 287170.0, 291955.0, 293426.0]
]

x_ancestor_souffle_log = list(map(lambda x: math.log(x, 2), x_ancestor_souffle))
y_ancestor_souffle_mean = list(map(lambda l: np.mean(l), y_ancestor_souffle))
y_ancestor_souffle_mean_log = list(map(lambda x: math.log(x, 2), y_ancestor_souffle_mean))
g = list(map(lambda x: 2.30 * x - 14.0, x_ancestor_souffle_log))
handle_souffle, = plt.plot(x_ancestor_souffle_log, y_ancestor_souffle_mean_log)
handle_g, = plt.plot(x_ancestor_souffle_log, g)

plt.legend([handle_souffle, handle_g],
           ['Souffle (Semi-Naive) Mean', 'O(N^2.35)'])
plt.xlabel('log(N)', fontsize=18)
plt.ylabel('log(t [ms])', fontsize=16)

plt.show()
